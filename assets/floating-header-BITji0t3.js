const T=(i,r,o={})=>new Promise((l,n)=>{fetch(r).then(t=>{if(!t.ok)throw new Error(`Failed to load ${r}: ${t.statusText}`);return t.text()}).then(t=>{const c=document.querySelector(i);if(!c)return console.warn(`loadHTML: target selector '${i}' not found.`),n(new Error(`Target selector '${i}' not found`));const{position:s="innerHTML"}=o;s==="innerHTML"?c.innerHTML=t:c.insertAdjacentHTML(s,t),l()}).catch(t=>{console.error(t),n(t)})});(()=>{const i=(e,a=document)=>Array.from(a.querySelectorAll(e)),r=(e,a=document)=>a.querySelector(e);let o=null,l=null,n=null,t=null;const c="/turf-grass/partials/broker-login.html",s="BROKER",d="123",f="/turf-grass/broker/broker.html",w=700;function v(){if(!o){console.warn("Modal not initialized");return}o.hidden=!1,document.body.style.overflow="hidden",setTimeout(()=>{n&&n.focus()},40)}function g(){if(!o){console.warn("Modal not initialized");return}o.hidden=!0,l&&l.reset(),b(),document.body.style.overflow=""}function b(){l&&(i(".bl-error",l).forEach(e=>{e.classList.remove("bl-error")}),i(".bl-errtext",l).forEach(e=>{e.remove()}))}function m(e,a){e.classList.add("bl-error");const u=document.createElement("div");u.className="bl-errtext",u.innerHTML=`<i class="fa-solid fa-circle-exclamation"></i> ${a}`,e.insertAdjacentElement("afterend",u)}function E(){b();let e=!0;return(!n||!n.value.trim())&&(n&&m(n,"Username is required"),e=!1),(!t||!t.value)&&(t&&m(t,"Password is required"),e=!1),e}function L(e){const a=l&&l.querySelector('button[type="submit"]');if(a)if(a.disabled=e,a.classList.toggle("is-loading",e),e)a.dataset.originalLabel=a.textContent||"",a.textContent="Signing inâ€¦";else{const u=a.dataset.originalLabel;u&&(a.textContent=u,delete a.dataset.originalLabel)}}function h(){try{const e=window.AuthState;e&&e.login&&e.login({role:"broker",name:n&&n.value.trim()||""}),window.location.href=f}catch(e){console.error("Error during dashboard redirect:",e)}}function y(e){if(e.preventDefault(),!E())return;const a=n&&n.value.trim()||"",u=t&&t.value||"";L(!0),setTimeout(()=>{a===s&&u===d?h():(L(!1),n&&m(n,"Invalid credentials. Use demo username: BROKER"),t&&m(t,"Invalid credentials. Use demo password: 123"),n&&n.focus())},w)}function S(e){e.key==="Escape"&&o&&!o.hidden&&g()}function k(){if(o=r("#brokerLogin"),!o){console.warn("Broker login modal not found in DOM");return}if(l=r("#bl-form",o),n=r("#bl-user",o),t=r("#bl-pass",o),!l||!n||!t){console.error("Required form elements not found");return}const e=r("#dealerLoginBtn");e&&e.addEventListener("click",v),i(".bl-close, .bl-overlay",o).forEach(a=>{a.addEventListener("click",g)}),l.addEventListener("submit",y),document.addEventListener("keydown",S)}async function M(){try{await T("body",c,{position:"beforeend"}),setTimeout(k,10),console.log("Broker login modal initialized successfully")}catch(e){console.error("Failed to load broker login modal:",e)}}M(),window.BrokerLogin={open:v,close:g}})();(()=>{let i,r;function o(){i=document.getElementById("hamburgerMenu"),r=document.getElementById("mobileNav"),i&&r&&l()}function l(){i.addEventListener("click",n),r.querySelectorAll(".nav-link").forEach(s=>{s.addEventListener("click",t)}),document.addEventListener("click",s=>{!i.contains(s.target)&&!r.contains(s.target)&&t()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&t()})}function n(){i.classList.toggle("active"),r.classList.toggle("active"),r.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow=""}function t(){i.classList.remove("active"),r.classList.remove("active"),document.body.style.overflow=""}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o()})();document.addEventListener("DOMContentLoaded",function(){const i=document.querySelector(".header");document.querySelector(".contact-hero")||document.querySelector(".hero")||document.querySelector(".title-page");const r={offset:100,floatingClass:"floating"};let o=!1,l=!1;function n(){const f=window.scrollY>=r.offset;f!==o&&t(f),l=!1}function t(d){d?(i.classList.add(r.floatingClass),i.setAttribute("data-state","floating")):(i.classList.remove(r.floatingClass),i.removeAttribute("data-state")),o=d;const f=new CustomEvent("navbarStateChange",{detail:{floating:o}});window.dispatchEvent(f)}function c(){l||(requestAnimationFrame(()=>{n(),l=!1}),l=!0)}function s(){n(),window.addEventListener("scroll",c,{passive:!0});let d;window.addEventListener("resize",()=>{clearTimeout(d),d=setTimeout(()=>{n()},250)}),window.addEventListener("orientationchange",()=>{setTimeout(n,300)}),setTimeout(()=>{i.style.transition="all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)"},100)}s(),window.Navbar={enableFloating:()=>t(!0),disableFloating:()=>t(!1),toggleFloating:()=>t(!o),getState:()=>({floating:o}),refresh:()=>n()}});
